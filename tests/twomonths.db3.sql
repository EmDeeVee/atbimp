BEGIN TRANSACTION;
DROP TABLE IF EXISTS "month";
CREATE TABLE IF NOT EXISTS "month" (
	"id"	INTEGER NOT NULL,
	"year"	INTEGER,
	"month"	INTEGER,
	PRIMARY KEY("id" AUTOINCREMENT)
);
DROP TABLE IF EXISTS "account";
CREATE TABLE IF NOT EXISTS "account" (
	"id"	INTEGER NOT NULL,
	"alias"	TEXT,
	"acct_routing"	TEXT,
	"acct_number"	TEXT,
	"nick_name"	TEXT,
	PRIMARY KEY("id" AUTOINCREMENT)
);
DROP TABLE IF EXISTS "import";
CREATE TABLE IF NOT EXISTS "import" (
	"id"	INTEGER NOT NULL,
	"time_stamp"	TEXT DEFAULT CURRENT_TIMESTAMP,
	"source"	TEXT,
	PRIMARY KEY("id" AUTOINCREMENT)
);
DROP TABLE IF EXISTS "duplicate";
CREATE TABLE IF NOT EXISTS "duplicate" (
	"id"	INTEGER NOT NULL,
	"transaction_id"	INTEGER,
	PRIMARY KEY("id" AUTOINCREMENT)
);
DROP TABLE IF EXISTS "duplicate_entry";
CREATE TABLE IF NOT EXISTS "duplicate_entry" (
	"id"	INTEGER NOT NULL,
	"duplicate_id"	INTEGER,
	"import_id"	INTEGER,
	"import_line"	INTEGER,
	"date"	TEXT,
	"transaction_type"	TEXT,
	"customer_ref_number"	TEXT,
	"amount"	REAL,
	"dc"	TEXT,
	"balance"	REAL,
	"description"	TEXT,
	"bank_reference"	TEXT,
	FOREIGN KEY("import_id") REFERENCES "import"("id") ON DELETE CASCADE,
	FOREIGN KEY("duplicate_id") REFERENCES "duplicate"("id") ON DELETE CASCADE,
	PRIMARY KEY("id" AUTOINCREMENT)
);
DROP TABLE IF EXISTS "transaction";
CREATE TABLE IF NOT EXISTS "transaction" (
	"id"	INTEGER NOT NULL,
	"account_id"	INTEGER,
	"month_id"	INTEGER,
	"import_id"	INTEGER,
	"import_line"	INTEGER,
	"flag"	TEXT DEFAULT '',
	"date"	TEXT,
	"transaction_type"	TEXT,
	"customer_ref_number"	TEXT,
	"amount"	REAL,
	"dc"	TEXT,
	"balance"	REAL,
	"description"	TEXT,
	"bank_reference"	TEXT,
	FOREIGN KEY("import_id") REFERENCES "import"("id") ON DELETE CASCADE,
	FOREIGN KEY("month_id") REFERENCES "month"("id") ON DELETE CASCADE,
	FOREIGN KEY("account_id") REFERENCES "account"("id") ON DELETE CASCADE,
	PRIMARY KEY("id" AUTOINCREMENT)
);
DROP TABLE IF EXISTS "export1";
CREATE TABLE IF NOT EXISTS "export1" (
	"date"	TEXT,
	"account_rtn"	TEXT,
	"account_number"	TEXT,
	"transaction_type"	TEXT,
	"customer_ref_number"	TEXT,
	"debit_amount"	TEXT,
	"credit_amount"	TEXT,
	"running_balance_amount"	TEXT,
	"extended_text"	TEXT,
	"bank_reference_number"	TEXT
);
DROP TABLE IF EXISTS "export2";
CREATE TABLE IF NOT EXISTS "export2" (
	"date"	TEXT,
	"account_rtn"	TEXT,
	"account_number"	TEXT,
	"transaction_type"	TEXT,
	"customer_ref_number"	TEXT,
	"debit_amount"	TEXT,
	"credit_amount"	TEXT,
	"running_balance_amount"	TEXT,
	"extended_text"	TEXT,
	"bank_reference_number"	TEXT
);
INSERT INTO "month" ("id","year","month") VALUES (1,2022,12),
 (2,2022,11);
INSERT INTO "account" ("id","alias","acct_routing","acct_number","nick_name") VALUES (1,'1234','021907339','000555551234','Unlimited Account'),
 (2,'7890','021907339','000555557890','Savings Account');
INSERT INTO "import" ("id","time_stamp","source") VALUES (1,'2023-10-26 03:35:38','tests/twomonths.csv'),
 (2,'2023-10-26 03:35:44','tests/twomonths2.csv'),
 (3,'2023-10-26 03:35:49','tests/twomonthsdup.csv');
INSERT INTO "duplicate" ("id","transaction_id") VALUES (1,1),
 (2,18),
 (3,19),
 (4,28),
 (5,65),
 (6,66),
 (7,67);
INSERT INTO "duplicate_entry" ("id","duplicate_id","import_id","import_line","date","transaction_type","customer_ref_number","amount","dc","balance","description","bank_reference") VALUES (1,1,3,2,'2022-12-31','Fee','',9.95,'D',3210.29,'Monthly Maintenance Fees',''),
 (2,2,3,3,'2022-12-22','Withdrawal','',1.92,'D',236.65,'POS Purchase TIM HORTONS #25 TIM HORTONS #25',''),
 (3,3,3,4,'2022-12-22','Withdrawal','',7.0,'D',238.57,'POS Purchase JOHN''S NO FRILL JOHN''S NO FRILL',''),
 (4,4,3,5,'2022-12-18','Withdrawal','',8.97,'D',1059.12,'POS Purchase JOHN''S NO FRILL JOHN''S NO FRILL',''),
 (5,5,3,6,'2022-11-30','Fee','',9.95,'D',4450.78,'Monthly Maintenance Fees',''),
 (6,6,3,7,'2022-11-30','Transfer','',0.01,'D',4460.73,'Overdraft Interest',''),
 (7,6,2,5,'2022-11-30','Transfer','',0.01,'D',4460.73,'Overdraft Interest',''),
 (8,7,1,119,'2022-11-30','Withdrawal','',51.37,'D',4460.74,'POS Purchase JOHN''S NO FRILLS # 821 JOHN''S NO FRIL','');
INSERT INTO "transaction" ("id","account_id","month_id","import_id","import_line","flag","date","transaction_type","customer_ref_number","amount","dc","balance","description","bank_reference") VALUES (1,1,1,1,2,NULL,'2022-12-31','Fee','',9.95,'D',3210.29,'Monthly Maintenance Fees',''),
 (2,1,1,1,3,NULL,'2022-12-31','Withdrawal','',3.98,'D',3220.24,'POS Purchase CA COOP SNAKETOWN FOOD CA COOP SNAKET',''),
 (3,1,1,1,4,NULL,'2022-12-31','Withdrawal','',10.75,'D',3224.22,'POS Purchase JOHN''S NO FRILLS # 821 JOHN''S NO FRIL',''),
 (4,1,1,1,5,NULL,'2022-12-31','Withdrawal','',35.0,'D',3234.97,'POS Purchase SNAKETOWN LIONS SNAKETOWN LIONS',''),
 (5,1,1,1,6,NULL,'2022-12-31','Withdrawal','',56.58,'D',3269.97,'POS Purchase THE LIQUOR HUTC THE LIQUOR HUTC',''),
 (6,1,1,1,7,NULL,'2022-12-31','Withdrawal','',25.0,'D',3326.55,'POS Purchase PETRO-CANADA PETRO-CANADA           I',''),
 (7,1,1,1,8,NULL,'2022-12-30','Withdrawal','',114.72,'D',3351.55,'POS Purchase COSTCO WHOLESALE W164 COSTCO WHOLESAL',''),
 (8,1,1,1,9,NULL,'2022-12-30','Withdrawal','',36.22,'D',3466.27,'POS Purchase #384 SPORT CHEK #384 SPORT CHEK',''),
 (9,1,1,1,10,NULL,'2022-12-30','EFT','',2272.83,'C',3502.49,'Direct Deposit Payroll Deposit Big Boss inc',''),
 (10,1,1,1,11,NULL,'2022-12-29','EFT','',25.0,'D',1229.66,'Direct Debit Utility Bill Payment Snake twn pmnts',''),
 (11,1,1,1,12,NULL,'2022-12-29','EFT','',54.5,'D',1254.66,'Direct Debit Bill Payment Koodo Mobile',''),
 (12,1,1,1,13,NULL,'2022-12-29','Withdrawal','',69.54,'D',1309.16,'POS Purchase PHARMASAVE #327 PHARMASAVE #327',''),
 (13,1,1,1,14,NULL,'2022-12-28','Withdrawal','',202.64,'D',1378.7,'POS Purchase CANADIAN TIRE # CANADIAN TIRE #',''),
 (14,1,1,1,15,NULL,'2022-12-28','Payment','',1500.0,'C',1581.34,'e-Transfer Received',''),
 (15,1,1,1,16,NULL,'2022-12-24','Withdrawal','',67.69,'D',81.34,'POS Purchase CA COOP SNAKETWN CA COOP SNAKETWN',''),
 (16,1,1,1,17,NULL,'2022-12-24','Withdrawal','',65.58,'D',149.03,'POS Purchase JOHN''S NO FRILLS # 821 JOHN''S NO FRIL',''),
 (17,1,1,1,18,NULL,'2022-12-23','EFT','',22.04,'D',214.61,'Direct Debit Misc. Payments PAYPAL',''),
 (18,1,1,1,19,NULL,'2022-12-22','Withdrawal','',1.92,'D',236.65,'POS Purchase TIM HORTONS #25 TIM HORTONS #25',''),
 (19,1,1,1,20,NULL,'2022-12-22','Withdrawal','',7.0,'D',238.57,'POS Purchase JOHN''S NO FRILL JOHN''S NO FRILL',''),
 (20,1,1,1,21,NULL,'2022-12-21','Withdrawal','',29.65,'D',245.57,'POS Purchase THE HOME DEPOT THE HOME DEPOT',''),
 (21,1,1,1,22,NULL,'2022-12-21','Withdrawal','',4.22,'D',275.22,'POS Purchase TIM HORTONS #25 TIM HORTONS #25',''),
 (22,1,1,1,23,NULL,'2022-12-20','EFT','',160.83,'D',279.44,'Direct Debit Utility Bill Payment Enmax',''),
 (23,1,1,1,24,NULL,'2022-12-20','EFT','',255.57,'D',440.27,'Direct Debit Insurance AB Blue Cross',''),
 (24,1,1,1,25,NULL,'2022-12-20','Withdrawal','',7.33,'D',695.84,'POS Purchase THE HOME DEPOT THE HOME DEPOT',''),
 (25,1,1,1,26,NULL,'2022-12-20','Withdrawal','',35.64,'D',703.17,'POS Purchase BOB''S TAG SHOPPE BOB''S TAG SHOP',''),
 (26,1,1,1,27,NULL,'2022-12-20','Withdrawal','',20.31,'D',738.81,'POS Purchase TIM HORTONS #2525 TIM HORTONS #2525',''),
 (27,1,1,1,28,NULL,'2022-12-20','Payment','',300.0,'D',759.12,'Bill Payment ATB Mastercard to CAD Mastercard',''),
 (28,1,1,1,29,NULL,'2022-12-18','Withdrawal','',8.97,'D',1059.12,'POS Purchase JOHN''S NO FRILL JOHN''S NO FRILL',''),
 (29,1,1,1,30,NULL,'2022-12-18','Withdrawal','',6.3,'D',1068.09,'POS Purchase DOLLARAMA #1372 DOLLARAMA #1372',''),
 (30,1,1,1,31,NULL,'2022-12-18','Withdrawal','',26.77,'D',1074.39,'POS Purchase SNAKETOWN AQUAT SNAKETOWN AQUAT',''),
 (31,1,1,1,32,NULL,'2022-12-17','Withdrawal','',7.86,'D',1101.16,'POS Purchase CA COOP SNAKETWN CA COOP SNAKETWN',''),
 (32,1,1,1,33,NULL,'2022-12-16','EFT','',81.95,'D',1109.02,'Direct Debit Telephone Bill Payment FIDO MOBILE',''),
 (33,1,1,1,34,NULL,'2022-12-16','Withdrawal','',46.34,'D',1190.97,'POS Purchase JOHN''S NO FRILLS # 821 JOHN''S NO FRIL',''),
 (34,1,1,1,35,NULL,'2022-12-15','Withdrawal','',232.31,'D',1237.31,'POS Purchase COSTCO WHOLESALE W164 COSTCO WHOLESAL',''),
 (35,1,1,1,36,NULL,'2022-12-15','Withdrawal','',31.12,'D',1469.62,'POS Purchase LONDON DRUGS 24 LONDON DRUGS 24',''),
 (36,1,1,1,37,NULL,'2022-12-14','Withdrawal','',20.01,'D',1500.74,'POS Purchase PETRO-CANADA PETRO-CANADA           R',''),
 (37,1,1,1,38,NULL,'2022-12-14','Withdrawal','',23.09,'D',1520.75,'POS Purchase COSTCO WHOLESAL COSTCO WHOLESAL',''),
 (38,1,1,1,39,NULL,'2022-12-13','Withdrawal','',3.41,'D',1543.84,'POS Purchase STARBUCKS # 961 STARBUCKS # 961',''),
 (39,1,1,1,40,NULL,'2022-12-12','EFT','',98.75,'D',1547.25,'Direct Debit Bill Payment Telme Comm',''),
 (40,1,1,1,41,NULL,'2022-12-11','Withdrawal','',8.9,'D',1646.0,'POS Purchase DAIRY QUEEN #27 DAIRY QUEEN #27',''),
 (41,1,1,1,42,NULL,'2022-12-11','Withdrawal','',50.0,'D',1654.9,'POS Purchase WESTVIEW CO-OP QE 2 GB WESTVIEW CO-OP',''),
 (42,1,1,1,43,NULL,'2022-12-11','Withdrawal','',6.59,'D',1704.9,'POS Purchase FGP40012 DIDSBU FGP40012 DIDSBU',''),
 (43,1,1,1,44,NULL,'2022-12-11','Withdrawal','',33.14,'D',1711.49,'POS Purchase JOHN''S NO FRILL JOHN''S NO FRILL',''),
 (44,1,1,1,45,NULL,'2022-12-10','Payment','',40.0,'D',1744.63,'Bill Payment to CIBC  Mastercard',''),
 (45,1,1,1,46,NULL,'2022-12-10','Payment','',500.0,'D',1784.63,'Bill Payment ATB Mastercard to CAD Mastercard',''),
 (46,1,1,1,47,NULL,'2022-12-10','Withdrawal','',27.08,'D',2284.63,'POS Purchase PHARMASAVE #327 PHARMASAVE #327',''),
 (47,1,1,1,48,NULL,'2022-12-10','Withdrawal','',45.0,'D',2311.71,'POS Purchase PETRO-CANADA PETRO-CANADA           I',''),
 (48,1,1,1,49,NULL,'2022-12-09','EFT','',11.54,'D',2356.71,'Direct Debit Misc. Payments PAYPAL',''),
 (49,1,1,1,50,NULL,'2022-12-09','Withdrawal','',29.45,'D',2368.25,'POS Purchase PETRO-CANADA PETRO-CANADA           R',''),
 (50,1,1,1,51,NULL,'2022-12-08','Withdrawal','',19.76,'D',2397.7,'POS Purchase JOHN''S NO FRILLS # 821 JOHN''S NO FRIL',''),
 (51,1,1,1,52,NULL,'2022-12-08','Withdrawal','',23.6,'D',2417.46,'POS Purchase MICHAELS #3910 MICHAELS #3910',''),
 (52,1,1,1,53,NULL,'2022-12-08','Withdrawal','',11.98,'D',2441.06,'POS Purchase JOHN''S NO FRILL JOHN''S NO FRILL',''),
 (53,1,1,1,54,NULL,'2022-12-07','Withdrawal','',48.97,'D',2453.04,'POS Purchase COSTCO WHOLESALE W164 COSTCO WHOLESAL',''),
 (54,1,1,1,55,NULL,'2022-12-07','Withdrawal','',49.04,'D',2502.01,'POS Purchase WALMART STORE #5217 WALMART STORE #31',''),
 (55,1,1,1,56,NULL,'2022-12-07','Withdrawal','',28.62,'D',2551.05,'POS Purchase PETRO-CANADA PETRO-CANADA           I',''),
 (56,1,1,1,57,NULL,'2022-12-04','Withdrawal','',6.6,'D',2579.67,'POS Purchase INDUS RECREATIO INDUS RECREATIO',''),
 (57,1,1,1,58,NULL,'2022-12-02','Withdrawal','',178.52,'D',2586.27,'POS Purchase COSTCO WHOLESALE W164 COSTCO WHOLESAL',''),
 (58,1,1,1,59,NULL,'2022-12-02','Withdrawal','',129.01,'D',2764.79,'POS Purchase WALMART STORE #5217 WALMART STORE #31',''),
 (59,1,1,1,60,NULL,'2022-12-02','Transfer','',500.0,'D',2893.8,'Transfer to BUDDY JO',''),
 (60,1,1,1,61,NULL,'2022-12-01','EFT','',1729.48,'D',3393.8,'Direct Debit Mortgage Hello World Bank',''),
 (61,1,1,1,62,NULL,'2022-12-01','EFT','',414.97,'D',5123.28,'Direct Debit Insurance INTACT INS. CO.',''),
 (62,1,1,1,63,NULL,'2022-12-01','EFT','',118.0,'D',5538.25,'Direct Debit Insurance NON-GROUP',''),
 (63,1,1,1,64,NULL,'2022-12-01','Withdrawal','',99.93,'D',5656.25,'POS Purchase UFA SNAKETOWN C/L   #2 UFA SNAKETOWN',''),
 (64,1,1,1,65,NULL,'2022-12-01','EFT','',1305.4,'C',5756.18,'Direct Deposit Payroll Deposit Big Boss inc',''),
 (65,1,2,1,66,NULL,'2022-11-30','Fee','',9.95,'D',4450.78,'Monthly Maintenance Fees',''),
 (66,1,2,1,67,NULL,'2022-11-30','Transfer','',0.01,'D',4460.73,'Overdraft Interest',''),
 (67,1,2,1,68,NULL,'2022-11-30','Withdrawal','',51.37,'D',4460.74,'POS Purchase JOHN''S NO FRILLS # 821 JOHN''S NO FRIL',''),
 (68,1,2,1,69,NULL,'2022-11-30','Withdrawal','',20.01,'D',4512.11,'POS Purchase PETRO-CANADA PETRO-CANADA           R',''),
 (69,1,2,1,70,NULL,'2022-11-30','Payment','',4000.0,'C',4532.12,'e-Transfer Received',''),
 (70,1,2,1,71,NULL,'2022-11-29','Withdrawal','',42.03,'D',532.12,'POS Purchase JOHN''S NO FRILLS # 821 JOHN''S NO FRIL',''),
 (71,1,2,1,72,NULL,'2022-11-28','EFT','',54.5,'D',574.15,'Direct Debit Bill Payment Koodo Mobile',''),
 (72,1,2,1,73,NULL,'2022-11-28','EFT','',25.0,'D',628.65,'Direct Debit Utility Bill Payment T of Inn pmnts',''),
 (73,1,2,1,74,NULL,'2022-11-28','Withdrawal','',3.26,'D',653.65,'POS Purchase LONDON DRUGS 24 LONDON DRUGS 24',''),
 (74,1,2,1,75,NULL,'2022-11-27','Withdrawal','',6.25,'D',656.91,'POS Purchase JOHN''S NO FRILL JOHN''S NO FRILL',''),
 (75,1,2,1,76,NULL,'2022-11-26','Withdrawal','',23.93,'D',663.16,'POS Purchase PHARMASAVE #327 PHARMASAVE #327',''),
 (76,1,2,1,77,NULL,'2022-11-24','Payment','',300.0,'D',687.09,'Bill Payment ATB Mastercard to CAD Mastercard',''),
 (77,1,2,1,78,NULL,'2022-11-24','Payment','',1000.0,'C',987.09,'e-Transfer Received',''),
 (78,1,2,1,79,NULL,'2022-11-23','EFT','',22.04,'D',-12.91,'Direct Debit Misc. Payments PAYPAL',''),
 (79,1,2,1,80,NULL,'2022-11-23','Withdrawal','',14.86,'D',9.13,'POS Purchase WALMART STORE #5217 WALMART STORE #31',''),
 (80,1,2,1,81,NULL,'2022-11-23','Withdrawal','',8.17,'D',23.99,'POS Purchase JOHN''S NO FRILL JOHN''S NO FRILL',''),
 (81,1,2,1,82,NULL,'2022-11-22','EFT','',170.22,'D',32.16,'Direct Debit Utility Bill Payment Enmax',''),
 (82,1,2,1,83,NULL,'2022-11-22','Withdrawal','',56.69,'D',202.38,'POS Purchase WALMART STORE #1084 WALMART STORE #10',''),
 (83,1,2,1,84,NULL,'2022-11-21','EFT','',255.57,'D',259.07,'Direct Debit Insurance AB Blue Cross',''),
 (84,1,2,1,85,NULL,'2022-11-17','Transfer','',500.0,'C',514.64,'Transfer from BUDDY JO',''),
 (85,1,2,1,86,NULL,'2022-11-17','Withdrawal','',143.51,'D',14.64,'POS Purchase COSTCO WHOLESALE W164 COSTCO WHOLESAL',''),
 (86,1,2,1,87,NULL,'2022-11-17','Withdrawal','',77.98,'D',158.15,'POS Purchase WALMART STORE #5217 WALMART STORE #31',''),
 (87,1,2,1,88,NULL,'2022-11-16','EFT','',81.95,'D',236.13,'Direct Debit Telephone Bill Payment FIDO MOBILE',''),
 (88,1,2,1,89,NULL,'2022-11-16','Withdrawal','',100.0,'D',318.08,'Withdrawal ABM 4962 50TH STREET Innisfail',''),
 (89,1,2,1,90,NULL,'2022-11-15','Withdrawal','',3.41,'D',418.08,'POS Purchase STARBUCKS # 961 STARBUCKS # 961',''),
 (90,1,2,1,91,NULL,'2022-11-14','EFT','',53.91,'D',421.49,'Direct Debit Misc. Payments PAYPAL',''),
 (91,1,2,1,92,NULL,'2022-11-14','Withdrawal','',15.85,'D',475.4,'POS Purchase JOHN''S NO FRILL JOHN''S NO FRILL',''),
 (92,1,2,1,93,NULL,'2022-11-14','Withdrawal','',3.41,'D',491.25,'POS Purchase STARBUCKS # 961 STARBUCKS # 961',''),
 (93,1,2,1,94,NULL,'2022-11-11','Withdrawal','',48.19,'D',494.66,'POS Purchase WALMART STORE #5217 WALMART STORE #31',''),
 (94,1,2,1,95,NULL,'2022-11-11','Withdrawal','',224.49,'D',542.85,'POS Purchase COSTCO WHOLESALE W164 COSTCO WHOLESAL',''),
 (95,1,2,1,96,NULL,'2022-11-11','Withdrawal','',7.13,'D',767.34,'POS Purchase CA COOP SNAKETWN CA COOP SNAKETWN',''),
 (96,1,2,1,97,NULL,'2022-11-11','Withdrawal','',17.33,'D',774.47,'POS Purchase CA COOP SNAKETWN CA COOP SNAKETWN',''),
 (97,1,2,1,98,NULL,'2022-11-10','Withdrawal','',19.94,'D',791.8,'POS Purchase SANDSTONE PHARM SANDSTONE PHARM',''),
 (98,1,2,1,99,NULL,'2022-11-09','EFT','',98.75,'D',811.74,'Direct Debit Bill Payment Telme Comm',''),
 (99,1,2,1,100,NULL,'2022-11-09','Withdrawal','',44.95,'D',910.49,'POS Purchase WALMART STORE #5217 WALMART STORE #31',''),
 (100,1,2,1,101,NULL,'2022-11-09','Withdrawal','',4.22,'D',955.44,'POS Purchase TIM HORTONS #25 TIM HORTONS #25',''),
 (101,1,2,1,102,NULL,'2022-11-08','Withdrawal','',10.64,'D',959.66,'POS Purchase 7 DAYS LIQUOR S 7 DAYS LIQUOR S',''),
 (102,1,2,1,103,NULL,'2022-11-08','Withdrawal','',64.25,'D',970.3,'POS Purchase JOHN''S NO FRILLS # 821 JOHN''S NO FRIL',''),
 (103,1,2,1,104,NULL,'2022-11-07','Withdrawal','',15.0,'D',1034.55,'POS Purchase PETRO-CANADA PETRO-CANADA           I',''),
 (104,1,2,1,105,NULL,'2022-11-07','Withdrawal','',1.92,'D',1049.55,'POS Purchase TIM HORTONS #25 TIM HORTONS #25',''),
 (105,1,2,1,106,NULL,'2022-11-06','Withdrawal','',61.81,'D',1051.47,'POS Purchase WALMART STORE # WALMART STORE #',''),
 (106,1,2,1,107,NULL,'2022-11-04','Withdrawal','',166.57,'D',1113.28,'POS Purchase WALMART STORE #5217 WALMART STORE #31',''),
 (107,1,2,1,108,NULL,'2022-11-04','Payment','',500.0,'D',1279.85,'Bill Payment ATB Mastercard to CAD Mastercard',''),
 (108,1,2,1,109,NULL,'2022-11-04','Payment','',1500.0,'C',1779.85,'e-Transfer Received',''),
 (109,1,2,1,110,NULL,'2022-11-04','Withdrawal','',18.89,'D',279.85,'POS Purchase PETRO-CANADA PETRO-CANADA           I',''),
 (110,1,2,1,111,NULL,'2022-11-03','Withdrawal','',42.68,'D',298.74,'POS Purchase JOHN''S NO FRILLS # 821 JOHN''S NO FRIL',''),
 (111,1,2,1,112,NULL,'2022-11-03','Withdrawal','',4.46,'D',341.42,'POS Purchase STARBUCKS # 961 STARBUCKS # 961',''),
 (112,1,2,1,113,NULL,'2022-11-03','Withdrawal','',3.0,'D',345.88,'POS Purchase MCDONALD''S #584 MCDONALD''S #584',''),
 (113,1,2,1,114,NULL,'2022-11-01','EFT','',118.0,'D',348.88,'Direct Debit Insurance NON-GROUP',''),
 (114,1,2,1,115,NULL,'2022-11-01','EFT','',1729.48,'D',466.88,'Direct Debit Mortgage Hello World Bank',''),
 (115,1,2,1,116,NULL,'2022-11-01','EFT','',414.97,'D',2196.36,'Direct Debit Insurance INTACT INS. CO.',''),
 (116,1,2,1,117,NULL,'2022-11-01','Withdrawal','',1103.32,'D',2611.33,'POS Purchase BEST BUY #960 BEST BUY #960',''),
 (117,1,2,1,118,NULL,'2022-11-01','Transfer','',1300.0,'C',3714.65,'Transfer from BUDDY JO',''),
 (118,2,1,2,2,NULL,'2022-12-05','Payment','',228.86,'D',107.44,'Loan Payment to TPPL UNSECURED AND CASH SECURED',''),
 (119,2,2,2,3,NULL,'2022-11-05','Payment','',228.86,'D',336.3,'Loan Payment to TPPL UNSECURED AND CASH SECURED',''),
 (120,2,2,2,4,NULL,'2022-11-04','Payment','',500.0,'D',565.16,'Bill Payment ATB Mastercard to CAD Mastercard','');
INSERT INTO "export1" ("date","account_rtn","account_number","transaction_type","customer_ref_number","debit_amount","credit_amount","running_balance_amount","extended_text","bank_reference_number") VALUES ('2022-12-31','021907339','000555551234','Fee','','9.95',NULL,'3210.29','Monthly Maintenance Fees',''),
 ('2022-12-31','021907339','000555551234','Withdrawal','','3.98',NULL,'3220.24','POS Purchase CA COOP SNAKETOWN FOOD CA COOP SNAKET',''),
 ('2022-12-31','021907339','000555551234','Withdrawal','','10.75',NULL,'3224.22','POS Purchase JOHN''S NO FRILLS # 821 JOHN''S NO FRIL',''),
 ('2022-12-31','021907339','000555551234','Withdrawal','','35.0',NULL,'3234.97','POS Purchase SNAKETOWN LIONS SNAKETOWN LIONS',''),
 ('2022-12-31','021907339','000555551234','Withdrawal','','56.58',NULL,'3269.97','POS Purchase THE LIQUOR HUTC THE LIQUOR HUTC',''),
 ('2022-12-31','021907339','000555551234','Withdrawal','','25.0',NULL,'3326.55','POS Purchase PETRO-CANADA PETRO-CANADA           I',''),
 ('2022-12-30','021907339','000555551234','Withdrawal','','114.72',NULL,'3351.55','POS Purchase COSTCO WHOLESALE W164 COSTCO WHOLESAL',''),
 ('2022-12-30','021907339','000555551234','Withdrawal','','36.22',NULL,'3466.27','POS Purchase #384 SPORT CHEK #384 SPORT CHEK',''),
 ('2022-12-30','021907339','000555551234','EFT','',NULL,'2272.83','3502.49','Direct Deposit Payroll Deposit Big Boss inc',''),
 ('2022-12-29','021907339','000555551234','EFT','','25.0',NULL,'1229.66','Direct Debit Utility Bill Payment Snake twn pmnts',''),
 ('2022-12-29','021907339','000555551234','EFT','','54.5',NULL,'1254.66','Direct Debit Bill Payment Koodo Mobile',''),
 ('2022-12-29','021907339','000555551234','Withdrawal','','69.54',NULL,'1309.16','POS Purchase PHARMASAVE #327 PHARMASAVE #327',''),
 ('2022-12-28','021907339','000555551234','Withdrawal','','202.64',NULL,'1378.7','POS Purchase CANADIAN TIRE # CANADIAN TIRE #',''),
 ('2022-12-28','021907339','000555551234','Payment','',NULL,'1500.0','1581.34','e-Transfer Received',''),
 ('2022-12-24','021907339','000555551234','Withdrawal','','67.69',NULL,'81.34','POS Purchase CA COOP SNAKETWN CA COOP SNAKETWN',''),
 ('2022-12-24','021907339','000555551234','Withdrawal','','65.58',NULL,'149.03','POS Purchase JOHN''S NO FRILLS # 821 JOHN''S NO FRIL',''),
 ('2022-12-23','021907339','000555551234','EFT','','22.04',NULL,'214.61','Direct Debit Misc. Payments PAYPAL',''),
 ('2022-12-22','021907339','000555551234','Withdrawal','','1.92',NULL,'236.65','POS Purchase TIM HORTONS #25 TIM HORTONS #25',''),
 ('2022-12-22','021907339','000555551234','Withdrawal','','7.0',NULL,'238.57','POS Purchase JOHN''S NO FRILL JOHN''S NO FRILL',''),
 ('2022-12-21','021907339','000555551234','Withdrawal','','29.65',NULL,'245.57','POS Purchase THE HOME DEPOT THE HOME DEPOT',''),
 ('2022-12-21','021907339','000555551234','Withdrawal','','4.22',NULL,'275.22','POS Purchase TIM HORTONS #25 TIM HORTONS #25',''),
 ('2022-12-20','021907339','000555551234','EFT','','160.83',NULL,'279.44','Direct Debit Utility Bill Payment Enmax',''),
 ('2022-12-20','021907339','000555551234','EFT','','255.57',NULL,'440.27','Direct Debit Insurance AB Blue Cross',''),
 ('2022-12-20','021907339','000555551234','Withdrawal','','7.33',NULL,'695.84','POS Purchase THE HOME DEPOT THE HOME DEPOT',''),
 ('2022-12-20','021907339','000555551234','Withdrawal','','35.64',NULL,'703.17','POS Purchase BOB''S TAG SHOPPE BOB''S TAG SHOP',''),
 ('2022-12-20','021907339','000555551234','Withdrawal','','20.31',NULL,'738.81','POS Purchase TIM HORTONS #2525 TIM HORTONS #2525',''),
 ('2022-12-20','021907339','000555551234','Payment','','300.0',NULL,'759.12','Bill Payment ATB Mastercard to CAD Mastercard',''),
 ('2022-12-18','021907339','000555551234','Withdrawal','','8.97',NULL,'1059.12','POS Purchase JOHN''S NO FRILL JOHN''S NO FRILL',''),
 ('2022-12-18','021907339','000555551234','Withdrawal','','6.3',NULL,'1068.09','POS Purchase DOLLARAMA #1372 DOLLARAMA #1372',''),
 ('2022-12-18','021907339','000555551234','Withdrawal','','26.77',NULL,'1074.39','POS Purchase SNAKETOWN AQUAT SNAKETOWN AQUAT',''),
 ('2022-12-17','021907339','000555551234','Withdrawal','','7.86',NULL,'1101.16','POS Purchase CA COOP SNAKETWN CA COOP SNAKETWN',''),
 ('2022-12-16','021907339','000555551234','EFT','','81.95',NULL,'1109.02','Direct Debit Telephone Bill Payment FIDO MOBILE',''),
 ('2022-12-16','021907339','000555551234','Withdrawal','','46.34',NULL,'1190.97','POS Purchase JOHN''S NO FRILLS # 821 JOHN''S NO FRIL',''),
 ('2022-12-15','021907339','000555551234','Withdrawal','','232.31',NULL,'1237.31','POS Purchase COSTCO WHOLESALE W164 COSTCO WHOLESAL',''),
 ('2022-12-15','021907339','000555551234','Withdrawal','','31.12',NULL,'1469.62','POS Purchase LONDON DRUGS 24 LONDON DRUGS 24',''),
 ('2022-12-14','021907339','000555551234','Withdrawal','','20.01',NULL,'1500.74','POS Purchase PETRO-CANADA PETRO-CANADA           R',''),
 ('2022-12-14','021907339','000555551234','Withdrawal','','23.09',NULL,'1520.75','POS Purchase COSTCO WHOLESAL COSTCO WHOLESAL',''),
 ('2022-12-13','021907339','000555551234','Withdrawal','','3.41',NULL,'1543.84','POS Purchase STARBUCKS # 961 STARBUCKS # 961',''),
 ('2022-12-12','021907339','000555551234','EFT','','98.75',NULL,'1547.25','Direct Debit Bill Payment Telme Comm',''),
 ('2022-12-11','021907339','000555551234','Withdrawal','','8.9',NULL,'1646.0','POS Purchase DAIRY QUEEN #27 DAIRY QUEEN #27',''),
 ('2022-12-11','021907339','000555551234','Withdrawal','','50.0',NULL,'1654.9','POS Purchase WESTVIEW CO-OP QE 2 GB WESTVIEW CO-OP',''),
 ('2022-12-11','021907339','000555551234','Withdrawal','','6.59',NULL,'1704.9','POS Purchase FGP40012 DIDSBU FGP40012 DIDSBU',''),
 ('2022-12-11','021907339','000555551234','Withdrawal','','33.14',NULL,'1711.49','POS Purchase JOHN''S NO FRILL JOHN''S NO FRILL',''),
 ('2022-12-10','021907339','000555551234','Payment','','40.0',NULL,'1744.63','Bill Payment to CIBC  Mastercard',''),
 ('2022-12-10','021907339','000555551234','Payment','','500.0',NULL,'1784.63','Bill Payment ATB Mastercard to CAD Mastercard',''),
 ('2022-12-10','021907339','000555551234','Withdrawal','','27.08',NULL,'2284.63','POS Purchase PHARMASAVE #327 PHARMASAVE #327',''),
 ('2022-12-10','021907339','000555551234','Withdrawal','','45.0',NULL,'2311.71','POS Purchase PETRO-CANADA PETRO-CANADA           I',''),
 ('2022-12-09','021907339','000555551234','EFT','','11.54',NULL,'2356.71','Direct Debit Misc. Payments PAYPAL',''),
 ('2022-12-09','021907339','000555551234','Withdrawal','','29.45',NULL,'2368.25','POS Purchase PETRO-CANADA PETRO-CANADA           R',''),
 ('2022-12-08','021907339','000555551234','Withdrawal','','19.76',NULL,'2397.7','POS Purchase JOHN''S NO FRILLS # 821 JOHN''S NO FRIL',''),
 ('2022-12-08','021907339','000555551234','Withdrawal','','23.6',NULL,'2417.46','POS Purchase MICHAELS #3910 MICHAELS #3910',''),
 ('2022-12-08','021907339','000555551234','Withdrawal','','11.98',NULL,'2441.06','POS Purchase JOHN''S NO FRILL JOHN''S NO FRILL',''),
 ('2022-12-07','021907339','000555551234','Withdrawal','','48.97',NULL,'2453.04','POS Purchase COSTCO WHOLESALE W164 COSTCO WHOLESAL',''),
 ('2022-12-07','021907339','000555551234','Withdrawal','','49.04',NULL,'2502.01','POS Purchase WALMART STORE #5217 WALMART STORE #31',''),
 ('2022-12-07','021907339','000555551234','Withdrawal','','28.62',NULL,'2551.05','POS Purchase PETRO-CANADA PETRO-CANADA           I',''),
 ('2022-12-04','021907339','000555551234','Withdrawal','','6.6',NULL,'2579.67','POS Purchase INDUS RECREATIO INDUS RECREATIO',''),
 ('2022-12-02','021907339','000555551234','Withdrawal','','178.52',NULL,'2586.27','POS Purchase COSTCO WHOLESALE W164 COSTCO WHOLESAL',''),
 ('2022-12-02','021907339','000555551234','Withdrawal','','129.01',NULL,'2764.79','POS Purchase WALMART STORE #5217 WALMART STORE #31',''),
 ('2022-12-02','021907339','000555551234','Transfer','','500.0',NULL,'2893.8','Transfer to BUDDY JO',''),
 ('2022-12-01','021907339','000555551234','EFT','','1729.48',NULL,'3393.8','Direct Debit Mortgage Hello World Bank',''),
 ('2022-12-01','021907339','000555551234','EFT','','414.97',NULL,'5123.28','Direct Debit Insurance INTACT INS. CO.',''),
 ('2022-12-01','021907339','000555551234','EFT','','118.0',NULL,'5538.25','Direct Debit Insurance NON-GROUP',''),
 ('2022-12-01','021907339','000555551234','Withdrawal','','99.93',NULL,'5656.25','POS Purchase UFA SNAKETOWN C/L   #2 UFA SNAKETOWN',''),
 ('2022-12-01','021907339','000555551234','EFT','',NULL,'1305.4','5756.18','Direct Deposit Payroll Deposit Big Boss inc',''),
 ('2022-11-30','021907339','000555551234','Fee','','9.95',NULL,'4450.78','Monthly Maintenance Fees',''),
 ('2022-11-30','021907339','000555551234','Transfer','','0.01',NULL,'4460.73','Overdraft Interest',''),
 ('2022-11-30','021907339','000555551234','Withdrawal','','51.37',NULL,'4460.74','POS Purchase JOHN''S NO FRILLS # 821 JOHN''S NO FRIL',''),
 ('2022-11-30','021907339','000555551234','Withdrawal','','20.01',NULL,'4512.11','POS Purchase PETRO-CANADA PETRO-CANADA           R',''),
 ('2022-11-30','021907339','000555551234','Payment','',NULL,'4000.0','4532.12','e-Transfer Received',''),
 ('2022-11-29','021907339','000555551234','Withdrawal','','42.03',NULL,'532.12','POS Purchase JOHN''S NO FRILLS # 821 JOHN''S NO FRIL',''),
 ('2022-11-28','021907339','000555551234','EFT','','54.5',NULL,'574.15','Direct Debit Bill Payment Koodo Mobile',''),
 ('2022-11-28','021907339','000555551234','EFT','','25.0',NULL,'628.65','Direct Debit Utility Bill Payment T of Inn pmnts',''),
 ('2022-11-28','021907339','000555551234','Withdrawal','','3.26',NULL,'653.65','POS Purchase LONDON DRUGS 24 LONDON DRUGS 24',''),
 ('2022-11-27','021907339','000555551234','Withdrawal','','6.25',NULL,'656.91','POS Purchase JOHN''S NO FRILL JOHN''S NO FRILL',''),
 ('2022-11-26','021907339','000555551234','Withdrawal','','23.93',NULL,'663.16','POS Purchase PHARMASAVE #327 PHARMASAVE #327',''),
 ('2022-11-24','021907339','000555551234','Payment','','300.0',NULL,'687.09','Bill Payment ATB Mastercard to CAD Mastercard',''),
 ('2022-11-24','021907339','000555551234','Payment','',NULL,'1000.0','987.09','e-Transfer Received',''),
 ('2022-11-23','021907339','000555551234','EFT','','22.04',NULL,'-12.91','Direct Debit Misc. Payments PAYPAL',''),
 ('2022-11-23','021907339','000555551234','Withdrawal','','14.86',NULL,'9.13','POS Purchase WALMART STORE #5217 WALMART STORE #31',''),
 ('2022-11-23','021907339','000555551234','Withdrawal','','8.17',NULL,'23.99','POS Purchase JOHN''S NO FRILL JOHN''S NO FRILL',''),
 ('2022-11-22','021907339','000555551234','EFT','','170.22',NULL,'32.16','Direct Debit Utility Bill Payment Enmax',''),
 ('2022-11-22','021907339','000555551234','Withdrawal','','56.69',NULL,'202.38','POS Purchase WALMART STORE #1084 WALMART STORE #10',''),
 ('2022-11-21','021907339','000555551234','EFT','','255.57',NULL,'259.07','Direct Debit Insurance AB Blue Cross',''),
 ('2022-11-17','021907339','000555551234','Transfer','',NULL,'500.0','514.64','Transfer from BUDDY JO',''),
 ('2022-11-17','021907339','000555551234','Withdrawal','','143.51',NULL,'14.64','POS Purchase COSTCO WHOLESALE W164 COSTCO WHOLESAL',''),
 ('2022-11-17','021907339','000555551234','Withdrawal','','77.98',NULL,'158.15','POS Purchase WALMART STORE #5217 WALMART STORE #31',''),
 ('2022-11-16','021907339','000555551234','EFT','','81.95',NULL,'236.13','Direct Debit Telephone Bill Payment FIDO MOBILE',''),
 ('2022-11-16','021907339','000555551234','Withdrawal','','100.0',NULL,'318.08','Withdrawal ABM 4962 50TH STREET Innisfail',''),
 ('2022-11-15','021907339','000555551234','Withdrawal','','3.41',NULL,'418.08','POS Purchase STARBUCKS # 961 STARBUCKS # 961',''),
 ('2022-11-14','021907339','000555551234','EFT','','53.91',NULL,'421.49','Direct Debit Misc. Payments PAYPAL',''),
 ('2022-11-14','021907339','000555551234','Withdrawal','','15.85',NULL,'475.4','POS Purchase JOHN''S NO FRILL JOHN''S NO FRILL',''),
 ('2022-11-14','021907339','000555551234','Withdrawal','','3.41',NULL,'491.25','POS Purchase STARBUCKS # 961 STARBUCKS # 961',''),
 ('2022-11-11','021907339','000555551234','Withdrawal','','48.19',NULL,'494.66','POS Purchase WALMART STORE #5217 WALMART STORE #31',''),
 ('2022-11-11','021907339','000555551234','Withdrawal','','224.49',NULL,'542.85','POS Purchase COSTCO WHOLESALE W164 COSTCO WHOLESAL',''),
 ('2022-11-11','021907339','000555551234','Withdrawal','','7.13',NULL,'767.34','POS Purchase CA COOP SNAKETWN CA COOP SNAKETWN',''),
 ('2022-11-11','021907339','000555551234','Withdrawal','','17.33',NULL,'774.47','POS Purchase CA COOP SNAKETWN CA COOP SNAKETWN',''),
 ('2022-11-10','021907339','000555551234','Withdrawal','','19.94',NULL,'791.8','POS Purchase SANDSTONE PHARM SANDSTONE PHARM',''),
 ('2022-11-09','021907339','000555551234','EFT','','98.75',NULL,'811.74','Direct Debit Bill Payment Telme Comm',''),
 ('2022-11-09','021907339','000555551234','Withdrawal','','44.95',NULL,'910.49','POS Purchase WALMART STORE #5217 WALMART STORE #31',''),
 ('2022-11-09','021907339','000555551234','Withdrawal','','4.22',NULL,'955.44','POS Purchase TIM HORTONS #25 TIM HORTONS #25',''),
 ('2022-11-08','021907339','000555551234','Withdrawal','','10.64',NULL,'959.66','POS Purchase 7 DAYS LIQUOR S 7 DAYS LIQUOR S',''),
 ('2022-11-08','021907339','000555551234','Withdrawal','','64.25',NULL,'970.3','POS Purchase JOHN''S NO FRILLS # 821 JOHN''S NO FRIL',''),
 ('2022-11-07','021907339','000555551234','Withdrawal','','15.0',NULL,'1034.55','POS Purchase PETRO-CANADA PETRO-CANADA           I',''),
 ('2022-11-07','021907339','000555551234','Withdrawal','','1.92',NULL,'1049.55','POS Purchase TIM HORTONS #25 TIM HORTONS #25',''),
 ('2022-11-06','021907339','000555551234','Withdrawal','','61.81',NULL,'1051.47','POS Purchase WALMART STORE # WALMART STORE #',''),
 ('2022-11-04','021907339','000555551234','Withdrawal','','166.57',NULL,'1113.28','POS Purchase WALMART STORE #5217 WALMART STORE #31',''),
 ('2022-11-04','021907339','000555551234','Payment','','500.0',NULL,'1279.85','Bill Payment ATB Mastercard to CAD Mastercard',''),
 ('2022-11-04','021907339','000555551234','Payment','',NULL,'1500.0','1779.85','e-Transfer Received',''),
 ('2022-11-04','021907339','000555551234','Withdrawal','','18.89',NULL,'279.85','POS Purchase PETRO-CANADA PETRO-CANADA           I',''),
 ('2022-11-03','021907339','000555551234','Withdrawal','','42.68',NULL,'298.74','POS Purchase JOHN''S NO FRILLS # 821 JOHN''S NO FRIL',''),
 ('2022-11-03','021907339','000555551234','Withdrawal','','4.46',NULL,'341.42','POS Purchase STARBUCKS # 961 STARBUCKS # 961',''),
 ('2022-11-03','021907339','000555551234','Withdrawal','','3.0',NULL,'345.88','POS Purchase MCDONALD''S #584 MCDONALD''S #584',''),
 ('2022-11-01','021907339','000555551234','EFT','','118.0',NULL,'348.88','Direct Debit Insurance NON-GROUP',''),
 ('2022-11-01','021907339','000555551234','EFT','','1729.48',NULL,'466.88','Direct Debit Mortgage Hello World Bank',''),
 ('2022-11-01','021907339','000555551234','EFT','','414.97',NULL,'2196.36','Direct Debit Insurance INTACT INS. CO.',''),
 ('2022-11-01','021907339','000555551234','Withdrawal','','1103.32',NULL,'2611.33','POS Purchase BEST BUY #960 BEST BUY #960',''),
 ('2022-11-01','021907339','000555551234','Transfer','',NULL,'1300.0','3714.65','Transfer from BUDDY JO','');
INSERT INTO "export2" ("date","account_rtn","account_number","transaction_type","customer_ref_number","debit_amount","credit_amount","running_balance_amount","extended_text","bank_reference_number") VALUES ('2022-12-05','021907339','000555557890','Payment','','228.86',NULL,'107.44','Loan Payment to TPPL UNSECURED AND CASH SECURED',''),
 ('2022-11-05','021907339','000555557890','Payment','','228.86',NULL,'336.3','Loan Payment to TPPL UNSECURED AND CASH SECURED',''),
 ('2022-11-04','021907339','000555557890','Payment','','500.0',NULL,'565.16','Bill Payment ATB Mastercard to CAD Mastercard','');
DROP INDEX IF EXISTS "trans_idx";
CREATE INDEX IF NOT EXISTS "trans_idx" ON "transaction" (
	"account_id",
	"date",
	"amount",
	"dc",
	"balance",
	"description"
);
COMMIT;
